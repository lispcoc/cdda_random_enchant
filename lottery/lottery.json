[
  {
    "type": "effect_on_condition",
    "id": "EOC_random_enchant_lottery_main",
    "condition": { "expects_vars": [ "max_rank" ] },
    "effect": [
      { "math": [ "u_random_enchant_current", "=", "1" ] },
      { "set_condition": "cond", "condition": { "math": [ "u_random_enchant_current", "<=", "3" ] } },
      {
        "foreach": "array",
        "var": { "context_val": "target" },
        "target": [ "u_random_enchant_f_1", "u_random_enchant_f_2", "u_random_enchant_f_3" ],
        "effect": [
          { "math": [ "_rank", "=", "_max_rank" ] },
          {
            "weighted_list_eocs": [
              [ "EOC_random_enchant_lottery[ZOMBIE_KILLER]", { "const": 20 } ],
              [ "EOC_random_enchant_lottery[FLIGHT_KILLER]", { "const": 10 } ],
              [ "EOC_random_enchant_lottery[DRAIN_HP]", { "const": 10 } ],
              [ "EOC_random_enchant_lottery[DRAIN_MANA]", { "const": 10 } ],
              [ "EOC_random_enchant_lottery[STOP_TIME]", { "const": 10 } ]
            ]
          },
          {
            "if": { "compare_string": [ "zombie", { "context_val": "group" } ] },
            "then": {
              "weighted_list_eocs": [
                [ "EOC_random_enchant_lottery[ZOMBIE_KILLER]", { "const": 20 } ],
                [ "EOC_random_enchant_lottery[FLIGHT_KILLER]", { "const": 10 } ],
                [ "EOC_random_enchant_lottery[DRAIN_HP]", { "const": 10 } ],
                [ "EOC_random_enchant_lottery[DRAIN_MANA]", { "const": 10 } ],
                [ "EOC_random_enchant_lottery[STOP_TIME]", { "const": 10 } ]
              ]
            }
          }
        ]
      },
      { "u_message": "<context_val:difficulty>" }
    ]
  }
]
